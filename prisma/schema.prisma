generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
  relationMode = "prisma"
}

model User {
  id        String      @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  clerkId String @unique
  email String @unique
  entries JournalEntry[]
  analysis Analysis[]
}

model JournalEntry{
   id        String      @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId String
  user User @relation(fields: [userId],references: [id])
  
  content String @db.Text

  analysis Analysis?

  @@unique([userId,id],name: "userId_id")

}

model Analysis{
    id        String      @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  entryId String
  entry JournalEntry @relation(fields: [entryId],references: [id],onDelete: Cascade)

  userId String
  user User @relation(fields: [userId], references: [id],onDelete: Cascade)

  mood String
  summary String @db.Text
  color String
  negative Boolean
  subject String 
  sentimentScore Float @default(0)

  @@unique([entryId])
  @@index([userId])
}